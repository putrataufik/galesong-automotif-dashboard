<div class="container-fluid p-4">
  <div class="row mb-4">
    <div class="col-12">
      <h2 class="fw-bold text-dark mb-3">
        Dashboard <span class="text-primary">Galesong Otomotif</span>
      </h2>
      <app-filter (search)="onSearch($event)"></app-filter>
    </div>
  </div>

  <div class="content-wrapper">
    <!-- Loading -->
    <div *ngIf="loading" class="row g-4">
      <div class="col-12 text-center text-muted">
        <p>Loading data...</p>
      </div>
    </div>

    <!-- KPI Cards Section -->
    <div *ngIf="!loading && kpiData.length > 0" class="row g-4 mb-4">
      <div class="col-12">
        <h5 class="fw-semibold text-dark mb-3">Key Performance Indicators</h5>
        <div class="row g-3">
          <div
            *ngFor="let kpi of kpiData"
            class="col-12 col-sm-6 col-md-6 col-xl-3"
          >
            <app-kpi-card
              [title]="kpi.title"
              [value]="kpi.value"
              [unit]="kpi.unit"
              [icon]="kpi.icon"
              [bgColor]="kpi.bgColor"
            >
            </app-kpi-card>
          </div>
        </div>
      </div>
    </div>

    <!-- Charts Section -->
    <div *ngIf="!loading && hasAnyChartData()" class="row g-4 mb-4">
      <div class="col-12">
        <h5 class="fw-semibold text-dark mb-3">Analytics Charts</h5>
    
        <div class="row g-4">
          <ng-container *ngFor="let chart of chartConfigs">
            <div *ngIf="hasData(chart.key)" class="col-12 col-lg-6">
              <ng-container [ngSwitch]="chart.component">
                <app-revenue-expense-barchart
                  *ngSwitchCase="'app-revenue-expense-barchart'"
                  [data]="getData(chart.key)"
                  [title]="chart.title">
                </app-revenue-expense-barchart>
    
                <app-target-realization-barchart
                  *ngSwitchCase="'app-target-realization-barchart'"
                  [data]="getData(chart.key)"
                  [title]="chart.title">
                </app-target-realization-barchart>
    
                <app-sales-aftersales-linechart
                  *ngSwitchCase="'app-sales-aftersales-linechart'"
                  [data]="getData(chart.key)"
                  [title]="chart.title">
                </app-sales-aftersales-linechart>
    
                <app-branch-performance-barchart
                  *ngSwitchCase="'app-branch-performance-barchart'"
                  [data]="getData(chart.key)"
                  [title]="chart.title">
                </app-branch-performance-barchart>

                <app-sales-omzet-linechart
                  *ngSwitchCase="'app-sales-omzet-linechart'"
                  [data]="getData(chart.key)"
                  [title]="chart.title">
                </app-sales-omzet-linechart>
                
                <app-after-sales-omzet-linechart
                  *ngSwitchCase="'app-after-sales-omzet-linechart'"
                  [data]="getData(chart.key)"
                  [title]="chart.title">
                </app-after-sales-omzet-linechart>
              </ng-container>
            </div>
          </ng-container>
        </div>
      </div>
    </div>

    <!-- Placeholder jika belum ada data -->
    <div *ngIf="!loading && kpiData.length === 0" class="row g-4">
      <div class="col-12 text-center text-muted py-5">
        <i class="bi bi-search fs-1 text-muted mb-3"></i>
        <h6 class="text-muted">Belum Ada Data</h6>
        <p class="text-muted mb-0">
          Silakan pilih filter dan klik Cari untuk menampilkan data KPI dan
          chart.
        </p>
      </div>
    </div>

    <!-- Message when no chart data available -->
    <div
      *ngIf="!loading && kpiData.length > 0 && !hasAnyChartData()"
      class="row g-4"
    >
      <div class="col-12 text-center py-5">
        <i class="bi bi-bar-chart fs-1 text-muted mb-3"></i>
        <h6 class="text-muted">No Chart Data Available</h6>
        <p class="text-muted mb-0">
          Chart data will appear here once you search with valid filters.
        </p>
      </div>
    </div>
  </div>
</div>