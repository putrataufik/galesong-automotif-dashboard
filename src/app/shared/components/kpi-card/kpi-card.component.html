<!-- KPI Card Component -->
<div class="card border-0 shadow-sm h-100 kpi-card" [class.loading]="loading()">
  <div class="card-body p-3">
    @if (loading()) {
      <!-- Loading State -->
      <div class="d-flex align-items-center justify-content-center" style="height: 80px;">
        <div class="spinner-border spinner-border-sm text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
      </div>
    } @else {
      <!-- Content State -->
      <div class="d-flex align-items-center">
        <!-- Icon -->
        @if (data().icon) {
          <div class="me-3">
            <div class="icon-wrapper rounded-circle p-2 d-flex align-items-center justify-content-center" 
                 [style.background-color]="data().iconColor || '#f8f9fa'"
                 style="width: 40px; height: 40px;">
              <img [src]="'icons/' + data().icon + '.png'" 
                   [alt]="data().title" 
                   width="20" 
                   height="20">
            </div>
          </div>
        }

        <!-- Content -->
        <div class="flex-fill">
          <!-- Title -->
          <h6 class="kpi-title text-muted mb-1 small">
            {{ data().title }}
          </h6>

          <!-- Value -->
          <div class="kpi-value-container mb-2">
            <h4 class="kpi-value fw-bold mb-0 d-inline" 
                [style.color]="data().valueColor || '#212529'">
              {{ data().value }}
            </h4>
            @if (data().unit) {
              <small class="text-muted ms-1">{{ data().unit }}</small>
            }
          </div>

          <!-- Subtitle -->
          @if (data().subtitle) {
            <small class="text-muted d-block">{{ data().subtitle }}</small>
          }
        </div>
      </div>
    }
  </div>
</div>